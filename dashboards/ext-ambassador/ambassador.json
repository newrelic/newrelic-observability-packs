{
    "name": "Ambassador",
    "description": null,
    "pages": [
      {
        "name": "Ambassador Dashboard",
        "description": null,
        "widgets": [
          {
            "title": "",
            "layout": {
              "column": 1,
              "row": 1,
              "width": 2,
              "height": 6
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.markdown"
            },
            "rawConfiguration": {
              "text": "\n# ![Ambassador Logo](https://i.imgur.com/DJAfkjy.png)\n- - -\n### Overview\n`Ambassador` main usage:\n\nBuilding applications on Kubernetes is hard. Equip your entire organization with cloud native tools from Ambassador that integrate with your existing workflow. Make it easy for your teams to be able to do the right thing, repeatedly.\n\nAmbassador Edge Stack configuration is built on the concept of policies. A policy is a statement of intent and codified in a declarative configuration file. Ambassador Edge Stack takes advantage of Kubernetes Custom Resource Definitions (CRDs) to provide a declarative configuration workflow that is idiomatic with Kubernetes.\n\n### About this Dashboard\n\nThis dashboard is based on standard `Ambassador` Prometheus metrics ingested using Prometheus [remote write](https://newrelic.com/instant-observability/prometheus-remote-write/7dbd7355-c380-4211-bd32-fed9a65351af).  Most widgets utilize an `instance` facet to identify `Ambassador` instances in the cluster.  \n\n"
            }
          },
          {
            "title": "# of Registered Services",
            "layout": {
              "column": 3,
              "row": 1,
              "width": 1,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.billboard"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(envoy_cluster_manager_active_clusters) as 'Services' FROM Metric where endpoint='ambassador-admin' and instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%')  "
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "thresholds": [
                {
                  "alertSeverity": "WARNING",
                  "value": 0.1
                },
                {
                  "alertSeverity": "CRITICAL",
                  "value": 0
                }
              ]
            }
          },
          {
            "title": "eConf Duration (sec)",
            "layout": {
              "column": 4,
              "row": 1,
              "width": 3,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_econf_time_seconds) FROM Metric where instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance  TIMESERIES auto"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "Aconf Duration (sec)",
            "layout": {
              "column": 7,
              "row": 1,
              "width": 3,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_aconf_time_seconds) FROM Metric where instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance  TIMESERIES"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "Fetcher Duration (sec)",
            "layout": {
              "column": 10,
              "row": 1,
              "width": 3,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_fetcher_time_seconds) FROM Metric where instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance  TIMESERIES"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "IR Duration (sec)",
            "layout": {
              "column": 3,
              "row": 4,
              "width": 3,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_ir_time_seconds) FROM Metric WHERE instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance  TIMESERIES"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "Diagnostics Duration (sec)",
            "layout": {
              "column": 6,
              "row": 4,
              "width": 4,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_diagnostics_time_seconds) FROM Metric WHERE instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance  TIMESERIES"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "Reconfiguration Duration (sec)",
            "layout": {
              "column": 10,
              "row": 4,
              "width": 3,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(ambassador_reconfiguration_time_seconds) FROM Metric where instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance TIMESERIES AUTO"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "units": {
                "unit": "SECONDS"
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "Downstream Connections Length",
            "layout": {
              "column": 1,
              "row": 7,
              "width": 4,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT histogrampercentile(envoy_http_downstream_cx_length_ms_bucket, (100 * 0.95)) FROM Metric where endpoint ='ambassador-admin' and instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance TIMESERIES  auto"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "# of Active Connections",
            "layout": {
              "column": 5,
              "row": 7,
              "width": 4,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT latest(envoy_http_downstream_cx_http1_active) FROM Metric where endpoint ='ambassador-admin' and instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') FACET instance TIMESERIES AUTO"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          },
          {
            "title": "API Return Code (avg)",
            "layout": {
              "column": 9,
              "row": 7,
              "width": 4,
              "height": 3
            },
            "linkedEntityGuids": null,
            "visualization": {
              "id": "viz.line"
            },
            "rawConfiguration": {
              "facet": {
                "showOtherSeries": false
              },
              "legend": {
                "enabled": true
              },
              "nrqlQueries": [
                {
                  "accountId": 0,
                  "query": "SELECT average(envoy_http_downstream_rq_xx) as '2XX' FROM Metric  WHERE envoy_response_code_class IN (2, '2') and endpoint = 'ambassador-admin' and  instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') TIMESERIES AUTO "
                },
                {
                  "accountId": 0,
                  "query": "SELECT average(envoy_http_downstream_rq_xx) as '3XX' FROM Metric  WHERE envoy_response_code_class IN (3, '3') and endpoint = 'ambassador-admin'  and  instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') TIMESERIES AUTO"
                },
                {
                  "accountId": 0,
                  "query": "SELECT average(envoy_http_downstream_rq_xx) as '4XX' FROM Metric  WHERE envoy_response_code_class IN (4, '4') and endpoint = 'ambassador-admin'  and  instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') TIMESERIES AUTO"
                },
                {
                  "accountId": 0,
                  "query": "SELECT average(envoy_http_downstream_rq_xx) as '5XX' FROM Metric  WHERE envoy_response_code_class IN (5, '5') and endpoint = 'ambassador-admin' and instrumentation.name = 'remote-write' AND (app_kubernetes_io_name LIKE '%ambassador%' or app_newrelic_com_name LIKE '%ambassador%') TIMESERIES AUTO"
                }
              ],
              "platformOptions": {
                "ignoreTimeRange": false
              },
              "yAxisLeft": {
                "zero": true
              }
            }
          }
        ]
      }
    ]
  }