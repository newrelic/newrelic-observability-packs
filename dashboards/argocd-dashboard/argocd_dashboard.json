{
  "name": "Argo CD (Prometheus)",
  "description": null,
  "pages": [
    {
      "name": "Overview",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "![Argo CD Logo](https://avatars1.githubusercontent.com/u/30269780?s=110&v=4)\n\n### Overview\n[Argo CD](https://argo-cd.readthedocs.io/en/stable/)  is a declarative, GitOps continuous delivery tool for Kubernetes. Unlike external CD tools that only enable push-based deployments, Argo CD can pull updated code from Git repositories and deploy it directly to Kubernetes resources. It enables developers to manage both infrastructure configuration and application updates in one system.\n- - -\n### About this Dashboard\n\n- For information on the prerequisites for this dashboard, please visit the documentation [here](https://docs.newrelic.com/docs/infrastructure/prometheus-integrations/integrations-list/argocd-integration).\n- For more information on how to send Prometheus metrics to New Relic using Prometheus Agent or Prometheus Server, visit the documentation [here](https://docs.newrelic.com/docs/infrastructure/prometheus-integrations/get-started/send-prometheus-metric-data-new-relic/)\n\n\n"
          }
        },
        {
          "title": "",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 2,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": " from (from Metric select uniqueCount(server) as 'server' where metricName = 'argocd_cluster_info' and instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) facet prometheus_server) select sum(server) as 'Clusters'"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 7,
            "row": 1,
            "width": 2,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "from (from Metric select uniqueCount(name,':',project,':',prometheus_server) as 'name' where metricName = 'argocd_app_info' and instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and namespace in ({{ namespace }}) and dest_server in ({{ cluster }}) and health_status in ({{ health_status }}) and sync_status in ({{ sync_status }}) facet prometheus_server) select sum(name) as 'Applications'"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Application Count by Project",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 4
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT uniqueCount(concat(name, ':',project,':',prometheus_server)) as 'apps' FROM Metric where metricName = 'argocd_app_info' and instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and dest_server in ({{ cluster }}) and sync_status in ({{ sync_status }}) and health_status in ({{ health_status }}) facet project limit max"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 5,
            "row": 3,
            "width": 2,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": " from (from Metric select uniqueCount(concat(project,':',prometheus_server)) as 'projects' where metricName = 'argocd_app_info' and instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) facet prometheus_server) select sum(projects) as 'Projects'"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 7,
            "row": 3,
            "width": 2,
            "height": 2
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.billboard"
          },
          "rawConfiguration": {
            "dataFormatters": [],
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": " from (from Metric select uniqueCount(repo,':',server) as 'repos' where metricName = 'argocd_app_info' and instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) facet prometheus_server) select sum(repos) as 'Repositories'"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 5,
            "width": 1,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "### Application Status"
          }
        },
        {
          "title": "Health Status Breakdown",
          "layout": {
            "column": 2,
            "row": 5,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.pie"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": true
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "from (SELECT latest(health_status) as 'healthstatus' FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((health_status = '')) and health_status in ({{ health_status }}) facet (concat(name, ':', project, ':', prometheus_server)) LIMIT max) select count(healthstatus) facet healthstatus"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Current Health Status",
          "layout": {
            "column": 6,
            "row": 5,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "from (SELECT (latest(argocd_app_info)) FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((health_status = '')) and health_status in ({{ health_status }}) and sync_status in ({{ sync_status }}) FACET name, health_status LIMIT max)\nselect latest(health_status) facet name limit max"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Health Status",
          "layout": {
            "column": 9,
            "row": 5,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.area"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "from (SELECT uniqueCount(name, ':', project, ':', prometheus_server) as 'apps' FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((health_status = '')) and health_status in ({{ health_status }}) and sync_status in ({{ sync_status }}) and namespace in ({{ namespace }}) FACET health_status LIMIT max TIMESERIES) select sum(apps) facet health_status timeseries"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 8,
            "width": 1,
            "height": 6
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "### Sync Status"
          }
        },
        {
          "title": "Sync Status Breakdown",
          "layout": {
            "column": 2,
            "row": 8,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.pie"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": true
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "from (SELECT latest(sync_status) as 'syncstatus' FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((sync_status = '')) and sync_status in ({{ sync_status }}) facet (concat(name, ':', project, ':', prometheus_server)) LIMIT max) select count(syncstatus) facet syncstatus"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Current Sync Status",
          "layout": {
            "column": 6,
            "row": 8,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.table"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "from (SELECT (latest(argocd_app_info) as 'status') FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((health_status = '')) and sync_status in ({{ sync_status }}) FACET name, sync_status LIMIT max)\nselect latest(sync_status) facet name limit max"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Sync Status",
          "layout": {
            "column": 9,
            "row": 8,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.area"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "from (SELECT uniqueCount(name, ':', project, ':', prometheus_server) as 'apps' FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and NOT ((sync_status = '')) and sync_status in ({{ sync_status }}) FACET sync_status LIMIT max TIMESERIES) select sum(apps) facet sync_status timeseries"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Sync Activity",
          "layout": {
            "column": 2,
            "row": 11,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountIds": [],
                "query": "SELECT sum(argocd_app_sync_total) AS `sync` FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) FACET {{ grouping }} LIMIT 100 TIMESERIES"
              }
            ],
            "nullValues": {
              "nullValue": "default"
            },
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Sync Failure Count [Top 20]",
          "layout": {
            "column": 6,
            "row": 11,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.pie"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": true
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_app_sync_total) AS `Sync Failures` FROM Metric where instrumentation.name = 'remote-write' and prometheus_server in ({{ prometheus_server }}) and (phase RLIKE 'Error|Failed') and argocd_app_sync_total > 0 FACET {{ grouping }} limit 20"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        },
        {
          "title": "Sync Failures",
          "layout": {
            "column": 9,
            "row": 11,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_app_sync_total) AS 'Sync Failures' FROM Metric where prometheus_server in ({{ prometheus_server }}) and (phase RLIKE 'Error|Failed') and argocd_app_sync_total > 0 FACET name"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            }
          }
        }
      ]
    },
    {
      "name": "Controller Stats",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "#### The application controller is a Kubernetes controller which continuously monitors running applications and compares the current, live state against the desired target state (as specified in the repo). \n\nIt detects `OutOfSync` application state and optionally takes corrective action. It is responsible for invoking any user-defined hooks for lifecycle events (PreSync, Sync, PostSync)"
          }
        },
        {
          "title": "Memory Usage",
          "layout": {
            "column": 4,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_memstats_heap_alloc_bytes) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-metrics' FACET app_kubernetes_io_name LIMIT 100 TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "CPU Usage",
          "layout": {
            "column": 7,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT irate(process_cpu_seconds_total, 1 SECONDS) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-metrics' FACET app_kubernetes_io_name LIMIT 100 TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Goroutines",
          "layout": {
            "column": 10,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_goroutines) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-metrics' FACET app_kubernetes_io_name LIMIT 100 TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Reconciliation Performance Percentiles",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(argocd_app_reconcile_bucket, (100 * 0.95)) FROM Metric where instrumentation.name = 'remote-write' and dest_server in ({{ cluster }}) SINCE 60 MINUTES AGO UNTIL NOW FACET concat(dest_server,': 95%') LIMIT 100 TIMESERIES 300000 SLIDE BY 60000"
              },
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(argocd_app_reconcile_bucket, (100 * 0.50)) FROM Metric where instrumentation.name = 'remote-write' and dest_server in ({{ cluster }}) SINCE 60 MINUTES AGO UNTIL NOW FACET concat(dest_server, ': 50%') LIMIT 100 TIMESERIES 300000 SLIDE BY 60000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Reconciliation Performance Histogram (seconds)",
          "layout": {
            "column": 5,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.histogram"
          },
          "rawConfiguration": {
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT histogram(argocd_app_reconcile_bucket) as 'Reconciliation Performance (seconds)' FROM Metric where instrumentation.name = 'remote-write' and dest_server in ({{ cluster }})"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Reconciliation Activity",
          "layout": {
            "column": 9,
            "row": 4,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_app_reconcile_count) FROM Metric where instrumentation.name = 'remote-write' and dest_server in ({{ cluster }}) SINCE 60 MINUTES AGO UNTIL NOW FACET dest_server LIMIT MAX TIMESERIES 300000 SLIDE BY 60000"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": false
            }
          }
        },
        {
          "title": "K8s API Activity (requests by verb, resource)",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 12,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_app_k8s_request_total) FROM Metric where instrumentation.name = 'remote-write' and server in ({{ cluster }}) FACET tuple(verb, resource_kind) LIMIT 100 TIMESERIES 5 minutes SLIDE BY 1 minute"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Workqueue Depth",
          "layout": {
            "column": 1,
            "row": 10,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT (max(workqueue_depth) * cardinality(workqueue_depth)) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-metrics' FACET name, prometheus_server LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Pending kubectl run",
          "layout": {
            "column": 7,
            "row": 10,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT (max(argocd_kubectl_exec_pending) * cardinality(argocd_kubectl_exec_pending)) FROM Metric where instrumentation.name = 'remote-write' FACET command, prometheus_server LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Repo Server Stats",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "#### The repository server is an internal service which maintains a local cache of the Git repository holding the application manifests. It is responsible for generating and returning the Kubernetes manifests when provided the following inputs:\n\n- repository URL\n- revision (commit, tag, branch)\n- application path\n- template specific settings: parameters, helm values.yaml"
          }
        },
        {
          "title": "Memory Used Bytes",
          "layout": {
            "column": 5,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_memstats_heap_alloc_bytes) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-repo-server' FACET app_kubernetes_io_name LIMIT 100 TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Goroutines",
          "layout": {
            "column": 9,
            "row": 1,
            "width": 4,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_goroutines) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-repo-server' FACET app_kubernetes_io_name LIMIT 100 TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Git Requests (ls-remote)",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_git_request_total)FROM Metric where instrumentation.name = 'remote-write' and (request_type = 'ls-remote') FACET request_type, repo LIMIT 100 TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Git LS-Remote Performance - 95%ile",
          "layout": {
            "column": 7,
            "row": 4,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(argocd_git_request_duration_seconds_bucket, (100 * 0.95)) FROM Metric where instrumentation.name = 'remote-write' and (request_type = 'ls-remote') FACET request_type, repo LIMIT 100 TIMESERIES"
              }
            ],
            "nullValues": {
              "nullValue": "zero"
            },
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "SECONDS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Git Requests (checkout)",
          "layout": {
            "column": 1,
            "row": 7,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT sum(argocd_git_request_total) FROM Metric where instrumentation.name = 'remote-write' and (request_type = 'fetch') FACET request_type, repo LIMIT 100 TIMESERIES "
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Git Fetch Performance - 95%ile",
          "layout": {
            "column": 7,
            "row": 7,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT bucketpercentile(argocd_git_request_duration_seconds_bucket, (100 * 0.95)) FROM Metric where instrumentation.name = 'remote-write' and (request_type = 'fetch') FACET request_type, repo LIMIT 100 TIMESERIES"
              }
            ],
            "nullValues": {
              "nullValue": "zero"
            },
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "SECONDS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        }
      ]
    },
    {
      "name": "Server Stats",
      "description": null,
      "widgets": [
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "#### The API server is a gRPC/REST server which exposes the API consumed by the Web UI, CLI, and CI/CD systems. It has the following responsibilities:\n\n- application management and status reporting\n- invoking of application operations (e.g. sync, rollback, user-defined actions)\n- repository and cluster credential management (stored as K8s secrets)\n- authentication and auth delegation to external identity providers\n- RBAC enforcement\n- listener/forwarder for Git webhook events"
          }
        },
        {
          "title": "Goroutines",
          "layout": {
            "column": 4,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_goroutines) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' LIMIT 100 TIMESERIES facet app_kubernetes_io_name"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "COUNT"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "Memory Used Bytes",
          "layout": {
            "column": 7,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_memstats_heap_alloc_bytes) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' LIMIT 100 TIMESERIES facet app_kubernetes_io_name"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "BYTES"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "GC Time Quantiles",
          "layout": {
            "column": 10,
            "row": 1,
            "width": 3,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.line"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "SELECT average(go_gc_duration_seconds) FROM Metric where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics'  and quantile in ('0.5','0.75') limit max TIMESERIES facet concat(app_kubernetes_io_name, ' - ', if(quantile = '0.5', '50%ile', '75%ile'))"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "SECONDS"
            },
            "yAxisLeft": {
              "zero": true
            }
          }
        },
        {
          "title": "",
          "layout": {
            "column": 1,
            "row": 4,
            "width": 12,
            "height": 1
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.markdown"
          },
          "rawConfiguration": {
            "text": "#### gRPC Services"
          }
        },
        {
          "title": "ApplicationService Requests",
          "layout": {
            "column": 1,
            "row": 5,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='application.ApplicationService' TIMESERIES FACET grpc_code LIMIT MAX"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "ClusterService Requests",
          "layout": {
            "column": 7,
            "row": 5,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='cluster.ClusterService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "ProjectService Requests",
          "layout": {
            "column": 1,
            "row": 8,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='project.ProjectService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "RepositoryService Requests",
          "layout": {
            "column": 7,
            "row": 8,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='repository.RepositoryService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "SessionService Requests",
          "layout": {
            "column": 1,
            "row": 11,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='session.SessionService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "VersionService Requests",
          "layout": {
            "column": 7,
            "row": 11,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='version.VersionService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "AccountService Requests",
          "layout": {
            "column": 1,
            "row": 14,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='account.AccountService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        },
        {
          "title": "SettingsService Requests",
          "layout": {
            "column": 7,
            "row": 14,
            "width": 6,
            "height": 3
          },
          "linkedEntityGuids": null,
          "visualization": {
            "id": "viz.stacked-bar"
          },
          "rawConfiguration": {
            "facet": {
              "showOtherSeries": false
            },
            "legend": {
              "enabled": true
            },
            "nrqlQueries": [
              {
                "accountId": 0,
                "query": "FROM Metric select rate(sum(grpc_server_handled_total), 1 minute) where instrumentation.name = 'remote-write' and app_kubernetes_io_name = 'argocd-server-metrics' AND grpc_service ='cluster.SettingsService' FACET grpc_code LIMIT MAX TIMESERIES"
              }
            ],
            "platformOptions": {
              "ignoreTimeRange": false
            },
            "units": {
              "unit": "REQUESTS_PER_MINUTE"
            }
          }
        }
      ]
    }
  ],
  "variables": [
    {
      "name": "prometheus_server",
      "items": null,
      "defaultValues": [
        {
          "value": {
            "string": "*"
          }
        }
      ],
      "nrqlQuery": {
        "accountIds": [],
        "query": "from Metric select uniques(prometheus_server) where instrumentation.name = 'remote-write' and metricName like 'argocd%'"
      },
      "title": "Prometheus Server",
      "type": "NRQL",
      "isMultiSelection": false,
      "replacementStrategy": "STRING"
    },
    {
      "name": "cluster",
      "items": null,
      "defaultValues": [
        {
          "value": {
            "string": "*"
          }
        }
      ],
      "nrqlQuery": {
        "accountIds": [],
        "query": "from Metric select uniques(server) where metricName = 'argocd_cluster_info' and instrumentation.name = 'remote-write'"
      },
      "title": "Cluster",
      "type": "NRQL",
      "isMultiSelection": true,
      "replacementStrategy": "STRING"
    },
    {
      "name": "namespace",
      "items": null,
      "defaultValues": [
        {
          "value": {
            "string": "*"
          }
        }
      ],
      "nrqlQuery": {
        "accountIds": [],
        "query": "from Metric select uniques(namespace) where instrumentation.name = 'remote-write' and metricName like 'argocd%'"
      },
      "title": "Namespace",
      "type": "NRQL",
      "isMultiSelection": true,
      "replacementStrategy": "STRING"
    },
    {
      "name": "health_status",
      "items": [
        {
          "title": null,
          "value": "Healthy"
        },
        {
          "title": null,
          "value": "Progressing"
        },
        {
          "title": null,
          "value": "Suspended"
        },
        {
          "title": null,
          "value": "Missing"
        },
        {
          "title": null,
          "value": "Degraded"
        },
        {
          "title": null,
          "value": "Unknown"
        }
      ],
      "defaultValues": [
        {
          "value": {
            "string": "*"
          }
        },
        {
          "value": {
            "string": "Degraded"
          }
        },
        {
          "value": {
            "string": "Missing"
          }
        },
        {
          "value": {
            "string": "Unknown"
          }
        },
        {
          "value": {
            "string": "Suspended"
          }
        },
        {
          "value": {
            "string": "Healthy"
          }
        },
        {
          "value": {
            "string": "Progressing"
          }
        }
      ],
      "nrqlQuery": null,
      "title": "Health Status",
      "type": "ENUM",
      "isMultiSelection": true,
      "replacementStrategy": "STRING"
    },
    {
      "name": "sync_status",
      "items": [
        {
          "title": null,
          "value": "Synced"
        },
        {
          "title": null,
          "value": "OutOfSync"
        },
        {
          "title": null,
          "value": "Unknown"
        }
      ],
      "defaultValues": [
        {
          "value": {
            "string": "*"
          }
        },
        {
          "value": {
            "string": "Synced"
          }
        },
        {
          "value": {
            "string": "OutOfSync"
          }
        },
        {
          "value": {
            "string": "Unknown"
          }
        }
      ],
      "nrqlQuery": null,
      "title": "Sync Status",
      "type": "ENUM",
      "isMultiSelection": true,
      "replacementStrategy": "STRING"
    },
    {
      "name": "grouping",
      "items": [
        {
          "title": null,
          "value": "namespace"
        },
        {
          "title": null,
          "value": "name"
        },
        {
          "title": null,
          "value": "project"
        }
      ],
      "defaultValues": [
        {
          "value": {
            "string": "name"
          }
        }
      ],
      "nrqlQuery": null,
      "title": "Grouping",
      "type": "ENUM",
      "isMultiSelection": false,
      "replacementStrategy": "IDENTIFIER"
    }
  ]
}